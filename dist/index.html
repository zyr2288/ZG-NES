<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>测试</title>
	<script src="bundle.js"></script>
	<script>
		var nes = new NES();
	</script>
</head>

<body>
	<button onclick="OpenFile()">打开文件</button>
	<hr>
	<canvas></canvas>

	<script>
		async function OpenFile() {
			let file = await OpenFileDialog(".nes");
			nes.LoadFile(file);
		}

		function OpenFileDialog(accept) {
			return new Promise((resolve, reject) => {
				let input = document.createElement("input");
				input.type = "file";
				input.accept = accept;
				input.onchange = async (ev) => {
					if (!input.files || input.files.length == 0) {
						reject();
						return;
					}

					let reader = new FileReader();
					reader.onload = (ev) => {
						let temp = ev.target.result;
						let buffer = new Uint8Array(temp);
						resolve(buffer);
					}
					reader.readAsArrayBuffer(input.files[0]);
				}
				input.click();
			});
		}
	</script>
</body>

</html>